계층형 아키텍처의 문제
==

일반적인 아키텍처
--
웹(요청) - 도메인(비지니스 로직) - 영속성(도메인 엔티티의 상태 조회 및 변경)

계층형 아키텍처는 데이터베이스 주도 설계를 유도한다.
--
계층형 아키텍처의 토대는 데이터베이스임.

웹 계층은 도메인 계층에 의존, 도메인 계층은 영속성 계층에 의존함. -> 데이터베이스에 의존하게 됨.<br>
따라서 모든 것이 영속성 계층을 토대로 만들어짐. 

이전에는 데이터베이스의 구조를 먼저 생각하고 이를 토대로 도메인 로직을 구현했음.<br>
-> 도메인 로직을 먼저 만들고, 로직을 제대로 이해했는지 확인 후 영속성 계층과 웹 계층을 만들어야함.

> 데이터중심의 아키텍처로 개발하는 원인은 ORM 때문임.
- 특정한 계층에서는 같은 계층에 있는 컴포넌트나 아래에 있는 계층에만 접근 가능함.
  - 특정 포넌트에 접근 해야 할 경우 계층 아래로 내려버리면 된다 -> 깨진 창문 이론(안좋은 습관)
- 추가적인 아키텍처 규칙을 강제(규칙이 깨질 경우 빌드 실패)하는 게 아닌 경우가 아니라면 계층형은 좋은 선택이 아니다.

테스트하기 어려움
--
단 하나의 필드를 조작하는 것에 불과하더라도 도메인 로직을 웹 계층에 구현하게 된다.<br>
-> 책임이 섞이고 핵심 도메인 로직이 퍼져나갈 확률이 높음.

웹 계층 테스트에서 도메인 계층 뿐만아니라 영속성 계층도 mocking 해야한다.<br>
-> 복잡도가 높아짐. 테스트 설정이 복잡해짐. 
> 실제로 테스트를 위한 환경설정에 공을 들이고 확인하는 시간이 대다수.

유스케이스를 숨긴다.
--
기능을 추가하거나 변경할 적절한 위치를 찾는 일이 빈번하기 때문에 아키텍처는 코드를 빠르게 탐색하는데 도움이 되어야 한다.<br>
-> 계층형에서는 유스케이스가 간단해서 웹 계층에 존재할 수도 있고, 영속성 계층에도 존재 할 수 있음.<br>
-> 도메인 서비스가 여러개의 유스케이스(컨트롤러)를 담당하는 서비스가 될 수도 있다. > 많은 의존성, 테스트도 어려워짐.<br>

동시 작업이 어려워진다.
--
> "지연되는 소프트웨어 프로젝트에 인력을 더하는 것은 개발을 늦출 뿐이다." - 맨먼스 미신 : 소프트웨어 공학에 대한 에세이

동시 작업이 지원되는 아키텍처의 구조를 가진 프로젝트가 아니라면 인원이 많다고 해서 작업능률을 올리기 쉽지 않음.

계층형 아키텍처에서는 하나의 계층만을 위한 개발을 할 수 없다 -> 모든 계층과 연관되어 있기 때문.

넓은 서비스를 가진 프로젝트는 동시에 작업할 경우 merge conflict를 피할 수 없음. 후...

> 추가적인 규칙을 적용한다면 계층형 아키텍처는 유지보수하기 쉬워진다. 
> 하지만 계층형은 잘못된 방향으로 흘러가기 용이하기 때문에 엄격해야한다. 
